<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sherley Hall - Equipment Checkout (Live Shared)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --tcu-purple: #4d1979;
            --tcu-purple-dark: #3a1159;
            --tcu-purple-light: #6a2a9f;
            --tcu-grey: #a3a9ac;
            --tcu-white: #ffffff;
            --color-bg-primary: #fcfcf9;
            --color-text: #1f2121;
            --color-border: rgba(77, 25, 121, 0.2);
            --color-success: #21808d;
            --color-error: #c0152f;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, var(--tcu-purple) 0%, var(--tcu-purple-dark) 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--color-text);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: var(--tcu-white);
            margin-bottom: 30px;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.95;
            font-weight: 500;
        }

        .horned-frog-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .card {
            background: var(--tcu-white);
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            margin-bottom: 24px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--tcu-purple);
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        input[type="text"],
        select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: var(--tcu-white);
            color: var(--tcu-purple);
        }

        input::placeholder {
            color: var(--tcu-grey);
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: var(--tcu-purple);
            box-shadow: 0 0 0 3px rgba(77, 25, 121, 0.1);
        }

        .radio-group {
            display: flex;
            gap: 24px;
            margin-top: 8px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .radio-option input[type="radio"] {
            width: 20px;
            height: 20px;
            accent-color: var(--tcu-purple);
            cursor: pointer;
        }

        .radio-option label {
            margin: 0;
            cursor: pointer;
            font-weight: 500;
            text-transform: none;
            letter-spacing: normal;
            color: var(--tcu-purple);
        }

        .item-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px,1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .item-option {
            padding: 12px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: var(--tcu-white);
            color: #000;
        }

        .item-option:hover {
            border-color: var(--tcu-purple);
            background: rgba(77, 25, 121, 0.05);
        }

        .item-option.selected {
            border-color: var(--tcu-purple);
            background: rgba(77, 25, 121, 0.1);
            font-weight: 600;
        }

        .item-icon {
            font-size: 2em;
            margin-bottom: 8px;
        }

        .btn {
            width: 100%;
            padding: 16px 32px;
            background: var(--tcu-purple);
            color: var(--tcu-white);
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 12px rgba(77, 25, 121, 0.3);
        }

        .btn:hover:enabled {
            background: var(--tcu-purple-light);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(77, 25, 121, 0.4);
        }

        .btn:disabled {
            opacity: 0.7;
            cursor: default;
        }

        .success-message {
            background: rgba(33, 128, 141, 0.15);
            color: var(--color-success);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 24px;
            text-align: center;
            font-weight: 600;
            border: 2px solid var(--color-success);
            display: none;
        }

        .success-message.show {
            display: block;
        }

        .transaction-log {
            margin-top: 32px;
        }

        .transaction-log h2 {
            color: var(--tcu-white);
            margin-bottom: 16px;
            font-size: 1.8em;
            text-align: center;
        }

        .transaction-controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .filter-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-button {
            padding: 6px 12px;
            border-radius: 999px;
            border: 1px solid var(--tcu-white);
            background: transparent;
            color: var(--tcu-white);
            font-size: 0.8em;
            font-weight: 600;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-button.active {
            background: rgba(255,255,255,0.15);
        }

        .search-input {
            min-width: 180px;
            padding: 8px 12px;
            border-radius: 999px;
            border: 1px solid var(--color-border);
            font-size: 0.9em;
        }

        .transaction-item {
            background: var(--tcu-white);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 12px;
            border-left: 4px solid var(--tcu-purple);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .transaction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .transaction-name {
            font-weight: 700;
            color: var(--tcu-purple);
            font-size: 1.1em;
        }

        .transaction-type {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--tcu-purple);
        }

        .transaction-type.checkout::before {
            content: "‚è±Ô∏è ";
        }

        .transaction-type.return::before {
            content: "‚úÖ ";
        }

        .transaction-details {
            color: #444;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .transaction-time {
            color: #999;
            font-size: 0.85em;
            margin-top: 8px;
            font-style: italic;
        }

        .no-transactions {
            text-align: center;
            padding: 40px;
            color: var(--tcu-grey);
            font-style: italic;
        }

        .status-pill {
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.75em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-open {
            background: rgba(192,21,47,0.08);
            color: var(--color-error);
        }

        .status-closed {
            background: rgba(33,128,141,0.12);
            color: var(--color-success);
        }

        .status-overdue {
            background: rgba(192,21,47,0.12);
            color: var(--color-error);
        }

        .return-button {
            margin-top: 10px;
            padding: 6px 12px;
            border-radius: 999px;
            border: none;
            background: var(--tcu-purple);
            color: var(--tcu-white);
            font-size: 0.8em;
            font-weight: 600;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .return-button:hover {
            background: var(--tcu-purple-light);
        }

        .undo-button {
            margin-left: 8px;
            padding: 4px 10px;
            border-radius: 999px;
            border: 1px solid var(--tcu-purple);
            background: transparent;
            color: var(--tcu-purple);
            font-size: 0.75em;
            font-weight: 600;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .undo-button:hover {
            background: rgba(77,25,121,0.08);
        }

        @media (max-width: 600px) {
            .header h1 { font-size: 1.8em; }
            .card { padding: 24px 16px; }
            .radio-group { flex-direction: column; gap: 12px; }
            .item-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="horned-frog-icon">üê∏</div>
            <h1>Sherley Hall</h1>
            <div class="subtitle">Equipment Checkout System (Live)</div>
        </div>

        <div class="card">
            <div id="successMessage" class="success-message">
                Transaction recorded successfully! üéâ
            </div>

            <form id="checkoutForm">
                <div class="form-group">
                    <label for="residentName">Resident Name *</label>
                    <input type="text" id="residentName" name="residentName" required placeholder="Enter your full name" list="residentNames">
                </div>

                <datalist id="residentNames">
                    <option value="Lizbeth Arteaga"></option>
                    <option value="Keeley O'Meara"></option>
                    <option value="Yasmin Robertson"></option>
                    <option value="Hailey Rosenberg"></option>
                    <option value="Grace Clark"></option>
                    <option value="Caitlin McFadden"></option>
                    <option value="Sophia Sansone"></option>
                    <option value="Jacqueline Moreno"></option>
                    <option value="Priscilla Basurto"></option>
                    <option value="Scarlett Fritz"></option>
                    <option value="Emory Eves"></option>
                    <option value="Kennedi Wingfield"></option>
                    <option value="Kylie Crews"></option>
                    <option value="Emma Leland"></option>
                    <option value="Adelaide Kauchak"></option>
                    <option value="Ashley Rogers"></option>
                    <option value="Sophia Beran"></option>
                    <option value="Eliana Wade"></option>
                    <option value="Blessing Musau"></option>
                    <option value="Kendra Broom"></option>
                    <option value="Bethany Stanley"></option>
                    <option value="Gabby Pouncey"></option>
                    <option value="Grace O'Connor"></option>
                    <option value="Molly Pawsat"></option>
                    <option value="Ella Growe"></option>
                    <option value="Ashley Behan"></option>
                    <option value="Eve Finley"></option>
                    <option value="Hanna Slama"></option>
                    <option value="Ava Kunkel"></option>
                    <option value="Bella Lupi"></option>
                    <option value="Parmida Faizy"></option>
                    <option value="Addy Cassell"></option>
                    <option value="Deisy Trejo"></option>
                    <option value="Karla Pichales"></option>
                    <option value="Sophie Hooker"></option>
                    <option value="Emmaline Byrd"></option>
                    <option value="Anna Potrusilova"></option>
                    <option value="Melissa Gutierrez"></option>
                    <option value="Brooke Murdock"></option>
                    <option value="Keira Kinnison"></option>
                    <option value="Kinslee Fullner"></option>
                    <option value="Kate Ellison"></option>
                    <option value="Jaclyn Franciosa"></option>
                    <option value="Maygan Munoz"></option>
                    <option value="Brooke Burnor"></option>
                    <option value="Caroline Griffith"></option>
                    <option value="Reese Ruffalo"></option>
                    <option value="Meredith Tovey"></option>
                    <option value="Charlotte Palen"></option>
                    <option value="Maggie Lopez"></option>
                    <option value="Piper Dunn"></option>
                    <option value="Bria Mancuso"></option>
                    <option value="Sophia Donnelly"></option>
                    <option value="Avery Roughen"></option>
                    <option value="Frida Najera"></option>
                    <option value="Lily Jeffrey-Patton"></option>
                    <option value="Matthew Smith"></option>
                    <option value="David Laurent"></option>
                    <option value="Cade Kvarda"></option>
                    <option value="Sebastian Aleksander"></option>
                    <option value="Benjamin Vu"></option>
                    <option value="Giancarlo Rodriguez"></option>
                    <option value="Chilab Gurung"></option>
                    <option value="Patrick Troy"></option>
                    <option value="Beckham Moses"></option>
                    <option value="Jack Genovese"></option>
                    <option value="Nick Macias"></option>
                    <option value="Braxton Durrett"></option>
                    <option value="John Collins"></option>
                    <option value="Cameron Ryle"></option>
                    <option value="Ezra Power"></option>
                    <option value="Hugo Sutton"></option>
                    <option value="Max Courson"></option>
                    <option value="Benjamin Brucato"></option>
                    <option value="Luke Nguyen"></option>
                    <option value="Anthony Ferullo"></option>
                    <option value="Jalen Walker"></option>
                    <option value="Luke Lammot"></option>
                    <option value="Hayden Hinds"></option>
                    <option value="Jack Bottini"></option>
                    <option value="Cade Alcantara"></option>
                    <option value="Michael Pulvirenti"></option>
                    <option value="Joe Revelos"></option>
                    <option value="Samson Romano"></option>
                    <option value="Sidd Krishnamurthy"></option>
                    <option value="Will Hedstrom"></option>
                    <option value="Emmett Pratt"></option>
                    <option value="Ryder Grieb"></option>
                    <option value="Nik Hart"></option>
                    <option value="John McNamara"></option>
                    <option value="Gavin Eades"></option>
                    <option value="Brian Mata Mata"></option>
                    <option value="Blake Schimmel"></option>
                    <option value="William Everitt"></option>
                    <option value="Dylan Palmer"></option>
                    <option value="Watson Fleming"></option>
                    <option value="Tommy Sticha"></option>
                    <option value="Pablo Lambreton Hervella"></option>
                    <option value="Sony Vo"></option>
                    <option value="Jake Bock"></option>
                    <option value="Jake Engstrom"></option>
                    <option value="Charles Coniaris"></option>
                    <option value="Ashton Hendel"></option>
                    <option value="Sammy Stremick"></option>
                    <option value="Carson Bradway"></option>
                    <option value="Aaron Kiah"></option>
                    <option value="Will Wood"></option>
                    <option value="Brady Gustafson"></option>
                    <option value="Max Roeder"></option>
                    <option value="Charlie Lobb"></option>
                    <option value="McCovey Jackson"></option>
                    <option value="Andrew Watson"></option>
                    <option value="Andrew Lubbeck"></option>
                    <option value="DJ Duntz"></option>
                    <option value="Alex Kneas"></option>
                    <option value="Reagan Wright"></option>
                    <option value="Alejandro Arellano"></option>
                    <option value="Jack Devine"></option>
                    <option value="Dallas Womack"></option>
                    <option value="Jax Nelson"></option>
                    <option value="Ben Olivero"></option>
                    <option value="Zacarey Crump"></option>
                    <option value="Logan Thistle"></option>
                    <option value="Conner McLeod"></option>
                    <option value="John Ghannoum"></option>
                    <option value="Braden Boone"></option>
                    <option value="Trevor Melton"></option>
                    <option value="a Miller"></option>
                    <option value="Voss Finkelstein"></option>
                    <option value="Jake Trimble"></option>
                    <option value="Henry Ferrari"></option>
                    <option value="Martin Passino"></option>
                    <option value="Brett Frauenhofer"></option>
                    <option value="Tully De Smet"></option>
                    <option value="Dutch Linerud"></option>
                    <option value="Kyler Patridge"></option>
                    <option value="Caden Pratt"></option>
                    <option value="Ethan Stell"></option>
                    <option value="Ando Butner"></option>
                    <option value="TJ Weber"></option>
                    <option value="Scott Barrett"></option>
                    <option value="Cade Rosenthal"></option>
                    <option value="Tyler Spellman"></option>
                    <option value="Tino Rios"></option>
                    <option value="Owen Forsthoffer"></option>
                    <option value="Noah Epstein"></option>
                    <option value="Wesley Rickers"></option>
                    <option value="Adityakumar Linganuri"></option>
                    <option value="Thor Gjerdrum"></option>
                    <option value="Dominic DeRosa"></option>
                    <option value="Ryan Dunne"></option>
                    <option value="Will Golinvaux"></option>
                    <option value="Nicolas Leonard"></option>
                    <option value="Steven Fridrich"></option>
                    <option value="Keegan Glynn"></option>
                    <option value="Harrison Ceppa"></option>
                    <option value="Hardy Reisner"></option>
                    <option value="Riley Regan"></option>
                    <option value="Alexander Hoshimi"></option>
                    <option value="Beck Wesley"></option>
                    <option value="Cathleen Johnsen"></option>
                    <option value="Grace Twomey"></option>
                    <option value="Amelia Bartsch"></option>
                    <option value="Angelina Wiens"></option>
                    <option value="Abby Sjobeck"></option>
                    <option value="Jessica Ward"></option>
                    <option value="Abby Smith"></option>
                    <option value="Reese Aldridge"></option>
                    <option value="Sally Murrah"></option>
                    <option value="Cassadie Armstrong"></option>
                    <option value="Madi Weber"></option>
                    <option value="Rachel Lear"></option>
                    <option value="Lucy Lakefish"></option>
                    <option value="Shelby Bush"></option>
                    <option value="Makayla Thompkins"></option>
                    <option value="Janiya Odom"></option>
                    <option value="Camila Bucio"></option>
                    <option value="Carter Moore"></option>
                    <option value="Gabrielle Dinan"></option>
                    <option value="Addie Redifer"></option>
                    <option value="Alanys Freitas"></option>
                    <option value="Keelyn Trubovich"></option>
                    <option value="Gaby Manzur"></option>
                    <option value="Margot McFarlane"></option>
                    <option value="Elyse Ennis"></option>
                    <option value="Izzy Conley"></option>
                    <option value="Sophia Ramsey"></option>
                    <option value="Addy White"></option>
                    <option value="Valeria Salinas"></option>
                    <option value="Isabella Graham"></option>
                    <option value="Iliana Almaraz"></option>
                    <option value="Karina Kiesling"></option>
                    <option value="Nathalie Ghannoum"></option>
                    <option value="Frida Riojas"></option>
                    <option value="Tyler Bristol"></option>
                    <option value="Sienna Wilkinson"></option>
                    <option value="Lilianna Ramos"></option>
                    <option value="Camila Aranda"></option>
                    <option value="Sy'Rai Lee"></option>
                    <option value="Keshia Hitoto"></option>
                    <option value="Karina Rodriguez-Alcorta"></option>
                    <option value="Aubrey Perez"></option>
                    <option value="Brilynn Conchas"></option>
                    <option value="Gweneth Parker"></option>
                    <option value="Samiya Lane"></option>
                    <option value="Malorye Foster"></option>
                    <option value="Amy Zollinger"></option>
                    <option value="Nora Fogarty"></option>
                    <option value="Abbie Galloway"></option>
                    <option value="Cha Cha Whitaker"></option>
                    <option value="Emily Holladay"></option>
                    <option value="Lisette Adrogue"></option>
                    <option value="Macy Fitz"></option>
                    <option value="Whitney Grunow"></option>
                    <option value="Jillian Sisley"></option>
                    <option value="Mia Daley"></option>
                    <option value="Sofia Brodie"></option>
                    <option value="Charlotte Reed"></option>
                    <option value="Ngoc Nguyen"></option>
                    <option value="Nguyen Bao Phuc Do"></option>
                    <option value="Maddy Dolence"></option>
                    <option value="Finley Clark"></option>
                    <option value="Ashley Martin"></option>
                    <option value="Blair Cooper"></option>
                    <option value="Sarah Emery"></option>
                    <option value="Darby Schroeder"></option>
                    <option value="Emma Machado"></option>
                    <option value="Kaitlyn Schroeder"></option>
                    <option value="Audrey Sell"></option>
                    <option value="Joselyn Casas Suarez"></option>
                    <option value="Sophie Siems"></option>
                    <option value="Grace Wolff"></option>
                    <option value="Zoe Vostry"></option>
                    <option value="McKenna Morgan"></option>
                    <option value="Sadie Tripaldi"></option>
                    <option value="Katie Barmmer"></option>
                    <option value="Cate Thibeault"></option>
                    <option value="Addison Besel"></option>
                    <option value="Brigid Shane"></option>
                    <option value="Sloane Longaker"></option>
                    <option value="Sophia Curran"></option>
                    <option value="Melina Nitsiotis"></option>
                    <option value="Aislin Fairchild"></option>
                    <option value="Emily Clark"></option>
                    <option value="Makayla Guerra"></option>
                    <option value="Jasmine Perez"></option>
                    <option value="Maia Rodriguez"></option>
                    <option value="Coco Ardell"></option>
                    <option value="Catie Schmitt"></option>
                    <option value="Ashley James"></option>
                    <option value="Hannah McCann"></option>
                    <option value="Morgan Miller"></option>
                    <option value="Stella Boyd"></option>
                    <option value="Makenzie Robinson"></option>
                    <option value="Mia Martinez"></option>
                    <option value="Kyler Moore"></option>
                    <option value="Lauren Mobeck"></option>
                    <option value="Maddie Merchant"></option>
                    <option value="Rylee Page"></option>
                    <option value="Kate Meixelsperger"></option>
                    <option value="Ryann Frazier"></option>
                    <option value="Emme Weis"></option>
                    <option value="Anabelle Budde"></option>
                    <option value="Claire Cox"></option>
                    <option value="Lexi Thomas"></option>
                    <option value="Ava Barton"></option>
                    <option value="Amelia Sharpe"></option>
                    <option value="Kaylee Roth"></option>
                    <option value="Lucy O'Brien"></option>
                    <option value="Claire Weindling"></option>
                    <option value="Avery Yerasimides"></option>
                    <option value="Ben Tinnes"></option>
                    <option value="Tyler Rager"></option>
                    <option value="Brayden Winn"></option>
                    <option value="Zion Junk"></option>
                    <option value="Alex Miller"></option>
                    <option value="Tobias Do"></option>
                    <option value="Mark Tripple"></option>
                    <option value="Spencer Smith"></option>
                    <option value="Connor Farris"></option>
                    <option value="Alex Pisano"></option>
                    <option value="Quinlan Hughes"></option>
                    <option value="Zach Harlow"></option>
                    <option value="Nicola Baccherini"></option>
                    <option value="Giri Anup"></option>
                    <option value="Josue Araica"></option>
                    <option value="Blaine Baker"></option>
                    <option value="Connor Newman"></option>
                    <option value="Emmett Nivaud"></option>
                    <option value="Brady Evans"></option>
                    <option value="AJ Dickinson"></option>
                    <option value="Brian Macchiarola"></option>
                    <option value="Nicholas Schroeder"></option>
                    <option value="Braxton Lewis"></option>
                    <option value="Diego Pozos"></option>
                    <option value="Ashton Wiseneske"></option>
                    <option value="Allen Hernandez-Castro"></option>
                    <option value="Stockard Bragan"></option>
                    <option value="Will Gordon"></option>
                    <option value="Gavin Wupperman"></option>
                    <option value="Max Nelson"></option>
                    <option value="Landon Shaver"></option>
                    <option value="Sam Tran"></option>
                    <option value="Kristopher Thomas"></option>
                    <option value="Derek Neal"></option>
                    <option value="Brendan Baldelli"></option>
                    <option value="Jack Luster"></option>
                    <option value="Andrew Schaeffer"></option>
                    <option value="Jovanni Guerrero"></option>
                    <option value="Jake Robertson"></option>
                    <option value="Carlos Quintanilla"></option>
                    <option value="Huesten Kolvet"></option>
                    <option value="Quentin DelSignore"></option>
                    <option value="Jacob Ellis"></option>
                    <option value="Khang Lam"></option>
                    <option value="Davis Garrett"></option>
                    <option value="Jacob Berg"></option>
                    <option value="Adam Berg"></option>
                    <option value="Parker Rice"></option>
                    <option value="Baker Schell"></option>
                    <option value="Gabriel Mora"></option>
                    <option value="Edwin Mireles"></option>
                    <option value="Sam Trego"></option>
                    <option value="Edwin Siembieda"></option>
                    <option value="Gavin Reed"></option>
                    <option value="Israel Ledezma"></option>
                    <option value="Michael Finn"></option>
                    <option value="Jack Lachanski"></option>
                </datalist>

                <div class="form-group">
                    <label>Transaction Type *</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="checkout" name="transactionType" value="checkout" checked>
                            <label for="checkout">Check Out</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="return" name="transactionType" value="return">
                            <label for="return">Return</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Select Equipment *</label>
                    <div class="item-grid">
                        <div class="item-option" data-item="HDMI Cable">
                            <div class="item-icon">üîå</div>
                            <div>HDMI Cable</div>
                        </div>
                        <div class="item-option" data-item="Pool Sticks">
                            <div class="item-icon">üé±</div>
                            <div>Pool Sticks</div>
                        </div>
                        <div class="item-option" data-item="Card Games">
                            <div class="item-icon">üÉè</div>
                            <div>Card Games</div>
                        </div>
                        <div class="item-option" data-item="Board Games">
                            <div class="item-icon">üé≤</div>
                            <div>Board Games</div>
                        </div>
                        <div class="item-option" data-item="Vacuum">
                            <div class="item-icon">üßπ</div>
                            <div>Vacuum</div>
                        </div>
                        <div class="item-option" data-item="Tool Kit">
                            <div class="item-icon">üîß</div>
                            <div>Tool Kit</div>
                        </div>
                        <div class="item-option" data-item="Ping Pong">
                            <div class="item-icon">üèì</div>
                            <div>Ping Pong</div>
                        </div>
                        <div class="item-option" data-item="Extension Cord">
                            <div class="item-icon">‚ö°</div>
                            <div>Extension Cord</div>
                        </div>
                        <div class="item-option" data-item="Other">
                            <div class="item-icon">‚ûï</div>
                            <div>Other</div>
                        </div>
                    </div>
                    <input type="hidden" id="selectedItem" name="selectedItem" required>

                    <div id="otherItemGroup" class="form-group" style="display:none; margin-top:12px;">
                        <label for="otherItem">Please describe the item *</label>
                        <input type="text" id="otherItem" name="otherItem" placeholder="e.g., Tripod, speaker, etc.">
                    </div>
                </div>

                <div class="form-group">
                    <label for="staffMember">Checked Out By *</label>
                    <select id="staffMember" name="staffMember" required>
                        <option value="" disabled selected>Select staff member</option>
                        <option>RA - Liz Arteaga</option>
                        <option>RA - Kinslee Fullner</option>
                        <option>RA - Matt Smith</option>
                        <option>RA - Ezra Power</option>
                        <option>RA - Shelby Bush</option>
                        <option>RA - Cathleeen Johnsen</option>
                        <option>RA - Aaron Kiah</option>
                        <option>RA - Owen Forsthoffer</option>
                        <option>RA - Kyler Moore</option>
                        <option>RA - Mia Daley</option>
                        <option>RA - Ben Tinnes</option>
                        <option>RA - Josue Araica</option>
                        <option>CA - Chilab Gurung</option>
                        <option>CA - Zacarey Crump</option>
                        <option>CA - Jacob Ellis</option>
                        <option>CM - Sam Tran</option>
                        <option>HD - Markel Harris</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="collateralItem">Collateral Item (ID or Keycard) *</label>
                    <input type="text" id="collateralItem" name="collateralItem" required placeholder="e.g., Student ID, Room Key">
                </div>

                <button type="submit" class="btn">Submit Transaction</button>
            </form>
        </div>

        <div class="transaction-log">
            <h2>Recent Transactions</h2>
            <div class="transaction-controls">
                <div class="filter-group">
                    <button type="button" class="filter-button active" data-filter="all">All</button>
                    <button type="button" class="filter-button" data-filter="open">Currently Checked Out</button>
                </div>
                <input type="text" id="searchInput" class="search-input" placeholder="Search by name or item">
            </div>
            <div id="transactionList">
                <div class="no-transactions">No transactions yet. Start by checking out equipment! üéØ</div>
            </div>
        </div>
    </div>

    <script>
        const form = document.getElementById('checkoutForm');
        const itemOptions = document.querySelectorAll('.item-option');
        const selectedItemInput = document.getElementById('selectedItem');
        const otherItemGroup = document.getElementById('otherItemGroup');
        const otherItemInput = document.getElementById('otherItem');
        const staffSelect = document.getElementById('staffMember');
        const transactionList = document.getElementById('transactionList');
        const successMessage = document.getElementById('successMessage');
        const filterButtons = document.querySelectorAll('.filter-button');
        const searchInputEl = document.getElementById('searchInput');
        const submitButton = document.querySelector('.btn');

        let transactions = [];
        let currentFilter = 'all';
        let searchTerm = '';

        // Convert ISO timestamp to DFW (America/Chicago) formatted string
        function formatTimestampToDFW(isoString) {
            if (!isoString) return '';
            const date = new Date(isoString);
            return date.toLocaleString('en-US', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                hour12: true,
                timeZone: 'America/Chicago'
            });
        }

        // Item selection
        itemOptions.forEach(option => {
            option.addEventListener('click', () => {
                itemOptions.forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                const value = option.getAttribute('data-item');
                selectedItemInput.value = value;

                if (value === 'Other') {
                    otherItemGroup.style.display = 'block';
                    otherItemInput.required = true;
                    otherItemInput.focus();
                } else {
                    otherItemGroup.style.display = 'none';
                    otherItemInput.required = false;
                    otherItemInput.value = '';
                }
            });
        });

        function isOverdue(t) {
            if (t.type !== 'checkout' || t.returned) return false;
            const created = t.createdAt;
            if (!created) return false;
            const sixHoursMs = 6 * 60 * 60 * 1000;
            return (Date.now() - created) > sixHoursMs;
        }

        function displayTransactions() {
            if (!transactions || transactions.length === 0) {
                transactionList.innerHTML = '<div class="no-transactions">No transactions yet. Start by checking out equipment! üéØ</div>';
                return;
            }

            let list = [...transactions];

            if (currentFilter === 'open') {
                list = list.filter(t => t.type === 'checkout' && !t.returned);
            }

            if (searchTerm && searchTerm.trim() !== '') {
                const term = searchTerm.trim().toLowerCase();
                list = list.filter(t =>
                    (t.name && t.name.toLowerCase().includes(term)) ||
                    (t.item && t.item.toLowerCase().includes(term))
                );
            }

            if (list.length === 0) {
                transactionList.innerHTML = '<div class="no-transactions">No matching transactions found. üîç</div>';
                return;
            }

            transactionList.innerHTML = list.map(t => `
                <div class="transaction-item ${t.type}">
                    <div class="transaction-header">
                        <span class="transaction-name">${t.name}</span>
                        <span class="transaction-type ${t.type}">${t.type === 'checkout' ? 'Check Out' : 'Return'}</span>
                    </div>
                    <div class="transaction-details">
                        <strong>Item:</strong> ${t.item}<br>
                        <strong>Collateral:</strong> ${t.collateral}<br>
                        <strong>Checked Out By:</strong> ${t.staff || 'Not recorded'}
                        ${t.type === 'checkout' ? `<div style="margin-top:8px;">
                            <span class="status-pill ${
                                t.returned ? 'status-closed' : (isOverdue(t) ? 'status-overdue' : 'status-open')
                            }">
                                ${
                                    t.returned
                                        ? 'Returned'
                                        : (isOverdue(t) ? 'Overdue (6+ hrs)' : 'Checked Out')
                                }
                            </span>
                            ${!t.returned ? `<button class="return-button" type="button" onclick="markAsReturned(${t.id})">
                                Mark Returned
                            </button>` : ''}
                            ${t.returned ? `<button class="undo-button" type="button" onclick="undoReturn(${t.id})">
                                Undo
                            </button>` : ''}
                        </div>` : ''}
                    </div>
                    <div class="transaction-time">${t.timestamp || ''}</div>
                </div>
            `).join('');
        }

        function markAsReturned(id) {
            const existing = transactions.find(t => t.id === id);
            if (!existing || existing.type !== 'checkout' || existing.returned) return;

            existing.returned = true;

            const now = Date.now();
            const isoNow = new Date().toISOString();
            const returnTransaction = {
                id: now,
                name: existing.name,
                type: 'return',
                item: existing.item,
                collateral: existing.collateral,
                staff: existing.staff,
                timestamp: formatTimestampToDFW(isoNow),
                returned: true,
                sourceId: existing.id,
                createdAt: now
            };

            transactions.unshift(returnTransaction);
            // Keep most recent on top
            transactions.sort((a, b) => b.createdAt - a.createdAt);
            displayTransactions();
            sendToGoogleSheets(returnTransaction);
        }

        function undoReturn(id) {
            const checkout = transactions.find(t => t.id === id);
            if (!checkout || checkout.type !== 'checkout' || !checkout.returned) return;

            checkout.returned = false;
            transactions = transactions.filter(t => !(t.type === 'return' && t.sourceId === id));
            transactions.sort((a, b) => b.createdAt - a.createdAt);
            displayTransactions();
        }

        window.markAsReturned = markAsReturned;
        window.undoReturn = undoReturn;

        filterButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                filterButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.getAttribute('data-filter') || 'all';
                displayTransactions();
            });
        });

        if (searchInputEl) {
            searchInputEl.addEventListener('input', () => {
                searchTerm = searchInputEl.value;
                displayTransactions();
            });
        }

        // Send a transaction to Google Sheets (POST)
        async function sendToGoogleSheets(transaction) {
            try {
                await fetch('https://script.google.com/macros/s/AKfycbzXDRr2TbMBsKvBTSpB_ZO-2iviV09C9JSEaQZOTLG-H8PkTuYYqtdUDA21F2yzmH-E/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: transaction.name,
                        collateral: transaction.collateral,
                        item: transaction.item,
                        type: transaction.type,
                        checkedOutBy: transaction.staff
                    })
                });
                console.log("Transaction sent to Google Sheets successfully");
            } catch (error) {
                console.error("Error sending to Google Sheets", error);
            }
        }

        // Load live transactions from Google Sheets (GET) with correct header mapping
        async function loadLiveTransactions() {
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbzXDRr2TbMBsKvBTSpB_ZO-2iviV09C9JSEaQZOTLG-H8PkTuYYqtdUDA21F2yzmH-E/exec');
                const allTransactions = await response.json();
                const now = Date.now();

                transactions = (allTransactions || []).map((t, index) => {
                    const rawTs = t["Timestamp"] || t.timestamp || '';
                    // If the sheet gives ISO, format; if it's already formatted, formatTimestampToDFW will still handle it reasonably.
                    const createdAt = t.createdAt || (rawTs ? (Date.parse(rawTs) || (now + index)) : (now + index));
                    return {
                        id: t.id || now + index,
                        name: t["Name"] || t.name,
                        item: t["Item"] || t.item,
                        collateral: t["Collateral"] || t.collateral,
                        type: t["Checkout/Return"] || t.type,
                        staff: t["checkedOutBy"] || t.checkedOutBy,
                        timestamp: formatTimestampToDFW(rawTs),
                        returned: t.returned,
                        createdAt: createdAt
                    };
                });

                // Normalize missing returned flag and sort by most recent
                transactions.forEach(tr => {
                    if (typeof tr.returned === 'undefined' || tr.returned === null) {
                        tr.returned = tr.type === 'return';
                    }
                });

                // Most recent at top
                transactions.sort((a, b) => b.createdAt - a.createdAt);

                displayTransactions();
            } catch (error) {
                console.error("Error loading live transactions", error);
            }
        }

        // Handle form submission
        form.addEventListener('submit', (e) => {
            e.preventDefault();

            if (!selectedItemInput.value) {
                alert('Please select an equipment item.');
                return;
            }

            const formData = new FormData(form);
            let itemName = selectedItemInput.value;

            if (itemName === 'Other') {
                const otherText = otherItemInput.value.trim();
                if (!otherText) {
                    alert('Please describe the "Other" item.');
                    otherItemInput.focus();
                    return;
                }
                itemName = otherText;
            }

            const staff = formData.get('staffMember');
            if (!staff) {
                alert('Please choose who checked it out.');
                return;
            }

            if (submitButton) {
                submitButton.disabled = true;
                submitButton.textContent = 'Saving...';
            }

            const now = Date.now();
            const isoNow = new Date().toISOString();
            const type = formData.get('transactionType') || 'checkout';

            const transaction = {
                id: now,
                name: formData.get('residentName'),
                type: type,
                item: itemName,
                collateral: formData.get('collateralItem'),
                staff: staff,
                timestamp: formatTimestampToDFW(isoNow),
                returned: type === 'return',
                createdAt: now
            };

            // Optimistic update locally
            transactions.unshift(transaction);
            transactions.sort((a, b) => b.createdAt - a.createdAt);
            displayTransactions();
            sendToGoogleSheets(transaction);

            successMessage.classList.add('show');
            setTimeout(() => {
                successMessage.classList.remove('show');
            }, 3000);

            form.reset();
            itemOptions.forEach(o => o.classList.remove('selected'));
            selectedItemInput.value = '';
            otherItemGroup.style.display = 'none';
            otherItemInput.required = false;
            otherItemInput.value = '';

            if (submitButton) {
                setTimeout(() => {
                    submitButton.disabled = false;
                    submitButton.textContent = 'Submit Transaction';
                }, 500);
            }

            // Refresh from live source after a short delay
            setTimeout(loadLiveTransactions, 2000);
        });

        // On page load: get live shared data and refresh every 60s
        window.onload = function () {
            loadLiveTransactions();
            setInterval(loadLiveTransactions, 60000); // every 60 seconds
        };
    </script>
</body>
</html>

